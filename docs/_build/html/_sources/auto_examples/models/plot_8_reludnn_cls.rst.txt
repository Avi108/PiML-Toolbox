
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples\models\plot_8_reludnn_cls.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_models_plot_8_reludnn_cls.py>`
        to download the full example code or to run this example in your browser via Binder

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_models_plot_8_reludnn_cls.py:


ReLU DNN Classification (Taiwan Credit)
=========================================

.. GENERATED FROM PYTHON SOURCE LINES 8-9

Experiment initialization and data preparation

.. GENERATED FROM PYTHON SOURCE LINES 9-18

.. code-block:: default

    import matplotlib.pyplot as plt
    from piml import Experiment
    from piml.models import ReluDNNClassifier

    exp = Experiment()
    exp.data_loader(data="TaiwanCredit", silent=True)
    exp.data_summary(feature_exclude=["LIMIT_BAL", "SEX", "EDUCATION", "MARRIAGE", "AGE"], silent=True)
    exp.data_prepare(target="FlagDefault", task_type="classification", silent=True)








.. GENERATED FROM PYTHON SOURCE LINES 19-20

Train Model

.. GENERATED FROM PYTHON SOURCE LINES 20-22

.. code-block:: default

    exp.model_train(model=ReluDNNClassifier(hidden_layer_sizes=(40, 40), l1_reg=0.0002, learning_rate=0.001),
                    name="ReLUDNN")







.. GENERATED FROM PYTHON SOURCE LINES 23-24

Evaluate predictive performance

.. GENERATED FROM PYTHON SOURCE LINES 24-26

.. code-block:: default

    exp.model_diagnose(model='ReLUDNN', show="accuracy_table")





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

              ACC      AUC  Recall Precision      F1
                                                
    Train  0.8200   0.7723  0.3619    0.6793  0.4722
    Test   0.8300   0.7708  0.3655    0.7064  0.4817
    Gap    0.0100  -0.0015  0.0036    0.0271  0.0095




.. GENERATED FROM PYTHON SOURCE LINES 27-28

Local Linear Model (LLM) summary plot

.. GENERATED FROM PYTHON SOURCE LINES 28-29

.. code-block:: default

    exp.model_interpret(model="ReLUDNN", show="llm_summary", figsize=(5, 4))




.. rst-class:: sphx-glr-script-out

 .. code-block:: none

          Count  Response Mean  Response Std  Local AUC  Global AUC
    0    6535.0         0.1053        0.3069     0.6037      0.7349
    1    4166.0         0.1066        0.3086     0.6477      0.6261
    2    1307.0         0.2295        0.4207     0.5999      0.5003
    3    1158.0         0.3100        0.4627     0.7819      0.7348
    4     903.0         0.1595        0.3663     0.6118      0.5528
    ..      ...            ...           ...        ...         ...
    300     1.0         1.0000           NaN        NaN      0.7364
    301     1.0         1.0000           NaN        NaN      0.5529
    302     1.0         1.0000           NaN        NaN      0.7370
    303     1.0         0.0000           NaN        NaN      0.7244
    304     1.0         1.0000           NaN        NaN      0.7134

    [305 rows x 5 columns]




.. GENERATED FROM PYTHON SOURCE LINES 30-31

Local Linear Model (LLM) parallel coordinate plot

.. GENERATED FROM PYTHON SOURCE LINES 31-32

.. code-block:: default

    exp.model_interpret(model="ReLUDNN", show="llm_pc", figsize=(5, 4))



.. image-sg:: /auto_examples/models/images/sphx_glr_plot_8_reludnn_cls_001.png
   :alt: Parallel Coordinate Plot of LLM Coefficients
   :srcset: /auto_examples/models/images/sphx_glr_plot_8_reludnn_cls_001.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 33-34

Local Linear Model (LLM) violin plot

.. GENERATED FROM PYTHON SOURCE LINES 34-35

.. code-block:: default

    exp.model_interpret(model="ReLUDNN", show="llm_violin", figsize=(5, 4))



.. image-sg:: /auto_examples/models/images/sphx_glr_plot_8_reludnn_cls_002.png
   :alt: Violin Plot of LLM Coefficients
   :srcset: /auto_examples/models/images/sphx_glr_plot_8_reludnn_cls_002.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 36-37

Global feature importance

.. GENERATED FROM PYTHON SOURCE LINES 37-38

.. code-block:: default

    exp.model_interpret(model="ReLUDNN", show="global_fi", figsize=(5, 4))



.. image-sg:: /auto_examples/models/images/sphx_glr_plot_8_reludnn_cls_003.png
   :alt: Feature Importance
   :srcset: /auto_examples/models/images/sphx_glr_plot_8_reludnn_cls_003.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 39-40

Global effect plot: with one feature

.. GENERATED FROM PYTHON SOURCE LINES 40-42

.. code-block:: default

    exp.model_interpret(model="ReLUDNN", show="global_effect_plot", uni_feature="PAY_1",
                        original_scale=True, figsize=(5, 4))



.. image-sg:: /auto_examples/models/images/sphx_glr_plot_8_reludnn_cls_004.png
   :alt: LLM Feature Importance of PAY_1: 62.54%
   :srcset: /auto_examples/models/images/sphx_glr_plot_8_reludnn_cls_004.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 43-44

Global effect plot: with two features

.. GENERATED FROM PYTHON SOURCE LINES 44-47

.. code-block:: default

    exp.model_interpret(model="ReLUDNN", show="global_effect_plot", bi_features=["PAY_1", "PAY_3"],
                        original_scale=True, figsize=(5, 4))




.. image-sg:: /auto_examples/models/images/sphx_glr_plot_8_reludnn_cls_005.png
   :alt: PAY_1, PAY_3
   :srcset: /auto_examples/models/images/sphx_glr_plot_8_reludnn_cls_005.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 48-49

Local feature importance without centering

.. GENERATED FROM PYTHON SOURCE LINES 49-51

.. code-block:: default

    exp.model_interpret(model="ReLUDNN", show="local_fi", sample_id=0, centered=False,
                        original_scale=True, figsize=(5, 4))



.. image-sg:: /auto_examples/models/images/sphx_glr_plot_8_reludnn_cls_006.png
   :alt: Predicted: 0.3117 | Actual: 0.0000
   :srcset: /auto_examples/models/images/sphx_glr_plot_8_reludnn_cls_006.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 52-53

Local feature importance with centering

.. GENERATED FROM PYTHON SOURCE LINES 53-54

.. code-block:: default

    exp.model_interpret(model="ReLUDNN", show="local_fi", sample_id=0, centered=True,
                        original_scale=True, figsize=(5, 4))


.. image-sg:: /auto_examples/models/images/sphx_glr_plot_8_reludnn_cls_007.png
   :alt: Predicted: 0.3117 | Actual: 0.0000
   :srcset: /auto_examples/models/images/sphx_glr_plot_8_reludnn_cls_007.png
   :class: sphx-glr-single-img






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  44.045 seconds)


.. _sphx_glr_download_auto_examples_models_plot_8_reludnn_cls.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example


    .. container:: binder-badge

      .. image:: images/binder_badge_logo.svg
        :target: https://mybinder.org/v2/gh/selfexplainml/piml-toolbox/main?urlpath=lab/tree/./docs/_build/html/notebooks/auto_examples/models/plot_8_reludnn_cls.ipynb
        :alt: Launch binder
        :width: 150 px



    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_8_reludnn_cls.py <plot_8_reludnn_cls.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_8_reludnn_cls.ipynb <plot_8_reludnn_cls.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
